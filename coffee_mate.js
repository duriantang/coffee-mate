// Generated by CoffeeScript 1.7.1
var Y, accumulate, all, any, best, bool, cart, chr, church, copy, cube, deepcopy, dict, extend, float, head, hex, int, iterator, json, list, log, max, max_index, memorize, min, min_index, obj, ord, random_gen, ranged_random_gen, reversed, size, sleep, square, str, sum, uri_decode, uri_encode, zip, _ref,
  __slice = [].slice;

log = (function() {
  var foo, logs;
  logs = [];
  if (typeof window !== "undefined" && window !== null) {
    window.logs = logs;
  }
  foo = function() {
    var args, ball, expr, f, op, _i, _len, _ref;
    args = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
    op = (_ref = args.slice(-1)[0]) === 'log' || _ref === 'warn' || _ref === 'error' ? args.pop() : 'log';
    ball = [];
    for (_i = 0, _len = args.length; _i < _len; _i++) {
      f = args[_i];
      if (typeof f === 'function') {
        expr = f.toString().replace(/^\s*function\s?\(\s?\)\s?{\s*return\s*([^]*?);?\s*}$/, '$1');
        if (expr.length <= 100) {
          expr = expr.replace(/[\r\n]{1,2}\s*/g, '');
        }
        ball.push("## " + expr + " ==>", f());
      } else {
        ball.push('##', f);
      }
    }
    console[op].apply(console, ball);
    return logs.push(ball);
  };
  foo.logs = logs;
  return foo;
})();

sleep = function(seconds, callback) {
  return setTimeout(callback, seconds * 1000);
};

dict = function(pairs) {
  var d, k, v, _i, _len, _ref;
  d = {};
  for (_i = 0, _len = pairs.length; _i < _len; _i++) {
    _ref = pairs[_i], k = _ref[0], v = _ref[1];
    d[k] = v;
  }
  return d;
};

_ref = (function() {
  var cp;
  cp = function(root, dep) {
    var k, r, v;
    if (dep === 0 || typeof root !== 'object') {
      return root;
    }
    if (root instanceof Array) {
      r = (function() {
        var _i, _len, _results;
        _results = [];
        for (_i = 0, _len = root.length; _i < _len; _i++) {
          v = root[_i];
          _results.push(cp(v, dep - 1));
        }
        return _results;
      })();
    } else {
      r = {};
      for (k in root) {
        v = root[k];
        r[k] = cp(v, dep - 1);
      }
    }
    return r;
  };
  return {
    copy: function(obj, depth) {
      if (depth == null) {
        depth = 1;
      }
      return cp(obj, depth);
    },
    deepcopy: function(obj, depth) {
      if (depth == null) {
        depth = Infinity;
      }
      return cp(obj, depth);
    }
  };
})(), copy = _ref.copy, deepcopy = _ref.deepcopy;

int = function(s, base) {
  var r;
  r = parseInt(s, base);
  if (!((s.slice != null) && r === parseInt(s.slice(0, -1), base))) {
    return r;
  } else {
    return null;
  }
};

float = function(s) {
  if (/^-?[0-9]*(\.[0-9]+)?([eE]-?[0-9]+)?$/.test(s)) {
    return parseFloat(s);
  } else {
    return null;
  }
};

str = function(x, base) {
  return x.toString(base);
};

bool = function(x) {
  if (x === true || x === false) {
    return x;
  } else {
    return null;
  }
};

hex = function(x) {
  return x.toString(16);
};

ord = function(c) {
  return c.charCodeAt();
};

chr = function(x) {
  return String.fromCharCode(x);
};

json = function(it, indent) {
  return JSON.stringify(it, null, indent);
};

obj = function(s) {
  return JSON.parse(s);
};

String.prototype.format = function(args) {
  return this.replace(/\{(\w+)\}/g, function(m, i) {
    if (args[i] != null) {
      return args[i];
    } else {
      return m;
    }
  });
};

String.prototype.repeat = function(n) {
  var pat, r, _ref1;
  _ref1 = ['', this], r = _ref1[0], pat = _ref1[1];
  while (n > 0) {
    if (n & 1) {
      r += pat;
    }
    n >>= 1;
    pat += pat;
  }
  return r;
};

String.prototype.cut = function(start_pat, end_pat) {
  var i, j;
  i = this.search(start_pat) + 1;
  if (i === 0) {
    return null;
  }
  j = this.substr(i).search(end_pat);
  if (j === -1) {
    return null;
  }
  return this.substr(i, j);
};

Object.defineProperties(Array.prototype, {
  first: {
    get: function() {
      return this[0];
    },
    set: function(v) {
      return this[0] = v;
    }
  },
  last: {
    get: function() {
      return this[this.length - 1];
    },
    set: function(v) {
      return this[this.length - 1] = v;
    }
  }
});

reversed = function(arr) {
  return arr.slice().reverse();
};

extend = function() {
  var base, d, defaults, k, r, v, _i, _len;
  base = arguments[0], defaults = 2 <= arguments.length ? __slice.call(arguments, 1) : [];
  r = base != null ? base : {};
  for (_i = 0, _len = defaults.length; _i < _len; _i++) {
    d = defaults[_i];
    if (d != null) {
      for (k in d) {
        v = d[k];
        if (r[k] == null) {
          r[k] = v;
        }
      }
    }
  }
  return r;
};

size = function(obj) {
  return Object.keys(obj).length;
};

uri_encode = function(obj, packer) {
  var k, v;
  if (packer == null) {
    packer = (function(o) {
      return str(o);
    });
  }
  if (obj === null) {
    return '';
  }
  return ((function() {
    var _results;
    _results = [];
    for (k in obj) {
      v = obj[k];
      _results.push("" + (encodeURIComponent(k)) + "=" + (encodeURIComponent(packer(v))));
    }
    return _results;
  })()).join('&');
};

uri_decode = function(uri, unpacker) {
  var d, k, s, v, _i, _j, _len, _ref1, _ref2, _ref3;
  if (unpacker == null) {
    unpacker = (function(s) {
      return s;
    });
  }
  d = {};
  _ref2 = (_ref1 = uri.match(/[^?=&]+=[^&]*/g)) != null ? _ref1 : [];
  for (_i = 0, _len = _ref2.length; _i < _len; _i++) {
    s = _ref2[_i];
    _ref3 = s.match(/([^=]+)=(.*)/), _j = _ref3.length - 2, k = _ref3[_j++], v = _ref3[_j++];
    d[decodeURIComponent(k)] = unpacker(decodeURIComponent(v));
  }
  return d;
};

random_gen = (function() {
  var hash;
  hash = function(x) {
    x = Math.sin(x) * 1e4;
    return x - Math.floor(x);
  };
  return function(seed) {
    var cnt;
    if (seed == null) {
      seed = Math.random();
    }
    cnt = hash(seed);
    return function() {
      return hash(++cnt);
    };
  };
})();

ranged_random_gen = function(range, seed) {
  var random;
  if (seed == null) {
    seed = Math.random();
  }
  random = random_gen(seed);
  return function() {
    return Math.floor(random() * range);
  };
};

iterator = (function() {
  var end, ret;
  end = new Object;
  ret = function(iterable, replaced_end) {
    var i;
    if (typeof iterable === 'function') {
      return iterable;
    }
    i = -1;
    return function() {
      i += 1;
      if (i < iterable.length) {
        if (iterable[i] === iterator.end) {
          if (replaced_end == null) {
            throw 'ITERATOR.END SHOULD NOT APPEARS IN LIST, PASS A SECOND ARG FOR REPLACE';
          }
          return replaced_end;
        } else {
          return iterable[i];
        }
      } else {
        return end;
      }
    };
  };
  ret.end = end;
  return ret;
})();

list = function(iterable) {
  var r, x;
  if (typeof iterable !== 'function') {
    return iterable;
  }
  r = [];
  x = iterable();
  while (x !== iterator.end) {
    r.push(x);
    x = iterable();
  }
  return r;
};

head = function(n) {
  return function(iter) {
    var c;
    iter = iterator(iter);
    c = 0;
    return function() {
      if (c < n) {
        c += 1;
        return iter();
      } else {
        return iterator.end;
      }
    };
  };
};

accumulate = function(fruit, nutri, foo) {
  var it, _i, _len;
  for (_i = 0, _len = nutri.length; _i < _len; _i++) {
    it = nutri[_i];
    fruit = foo(fruit, it);
  }
  return fruit;
};

best = function(better) {
  return function(iter) {
    var it, r;
    iter = iterator(iter);
    r = iter();
    if (r === iterator.end) {
      return null;
    }
    it = iter();
    while (it !== iterator.end) {
      r = better(it, r) ? it : r;
      it = iter();
    }
    return r;
  };
};

all = function(f) {
  if (typeof f !== 'function') {
    f = (function(x) {
      return x === f;
    });
  }
  return function(iter) {
    var x;
    iter = iterator(iter);
    x = iter();
    while (x !== iterator.end) {
      if (!f(x)) {
        return false;
      }
      x = iter();
    }
    return true;
  };
};

any = function(f) {
  var all_not;
  all_not = all(function(x) {
    return !f(x);
  });
  return function(iter) {
    return !(all_not(iter));
  };
};

zip = function() {
  var finished, iter, iters;
  iters = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
  iters = (function() {
    var _i, _len, _results;
    _results = [];
    for (_i = 0, _len = iters.length; _i < _len; _i++) {
      iter = iters[_i];
      _results.push(iterator(iter));
    }
    return _results;
  })();
  finished = (function() {
    var any_is_end, end;
    end = new Object;
    any_is_end = any(function(x) {
      return x === end;
    });
    return function(ls) {
      return any_is_end(iterator(ls, end));
    };
  })();
  return function() {
    var next;
    next = (function() {
      var _i, _len, _results;
      _results = [];
      for (_i = 0, _len = iters.length; _i < _len; _i++) {
        iter = iters[_i];
        _results.push(iter());
      }
      return _results;
    })();
    if (finished(next)) {
      return iterator.end;
    } else {
      return next;
    }
  };
};

cart = function() {
  var len, rec, rst, set, sets;
  sets = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
  sets = (function() {
    var _i, _len, _results;
    _results = [];
    for (_i = 0, _len = sets.length; _i < _len; _i++) {
      set = sets[_i];
      _results.push(list(set));
    }
    return _results;
  })();
  rst = [];
  len = sets.length;
  rec = function(st, d) {
    var x, _i, _len, _ref1, _results;
    if (d === len) {
      return rst.push(st);
    } else {
      _ref1 = sets[d];
      _results = [];
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        x = _ref1[_i];
        _results.push(rec(st.concat([x]), d + 1));
      }
      return _results;
    }
  };
  rec([], 0);
  return rst;
};

church = function(n) {
  var iter;
  iter = function(f, n, r) {
    if (n === 0) {
      return r;
    } else {
      return iter(f, n - 1, f(r));
    }
  };
  return function(f) {
    return function(x) {
      return iter(f, n + 0, x);
    };
  };
};

Y = function(f) {
  return (function(x) {
    return x(x);
  })((function(x) {
    return f((function(y) {
      return (x(x))(y);
    }));
  }));
};

memorize = function(f) {
  var cache;
  cache = {};
  return function() {
    var args, cached, key, r;
    args = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
    key = json(args);
    cached = cache[key];
    if (cached != null) {
      return cached;
    } else {
      r = f.apply(null, args);
      cache[key] = r;
      return r;
    }
  };
};

square = function(n) {
  return n * n;
};

cube = function(n) {
  return n * n * n;
};

sum = function(arr) {
  var r, x, _i, _len;
  r = 0;
  for (_i = 0, _len = arr.length; _i < _len; _i++) {
    x = arr[_i];
    r += x;
  }
  return r;
};

max = function(arr) {
  return best(function(a, b) {
    return a > b;
  })(arr);
};

min = function(arr) {
  return best(function(a, b) {
    return a < b;
  })(arr);
};

max_index = function(arr) {
  var _i, _ref1, _results;
  return best(function(i, j) {
    return arr[i] > arr[j];
  })((function() {
    _results = [];
    for (var _i = 0, _ref1 = arr.length; 0 <= _ref1 ? _i < _ref1 : _i > _ref1; 0 <= _ref1 ? _i++ : _i--){ _results.push(_i); }
    return _results;
  }).apply(this));
};

min_index = function(arr) {
  var _i, _ref1, _results;
  return best(function(i, j) {
    return arr[i] < arr[j];
  })((function() {
    _results = [];
    for (var _i = 0, _ref1 = arr.length; 0 <= _ref1 ? _i < _ref1 : _i > _ref1; 0 <= _ref1 ? _i++ : _i--){ _results.push(_i); }
    return _results;
  }).apply(this));
};

if (typeof module !== "undefined" && module !== null) {
  module.exports = {
    log: log,
    sleep: sleep,
    dict: dict,
    copy: copy,
    deepcopy: deepcopy,
    int: int,
    float: float,
    bool: bool,
    str: str,
    hex: hex,
    ord: ord,
    chr: chr,
    json: json,
    obj: obj,
    reversed: reversed,
    extend: extend,
    size: size,
    uri_encode: uri_encode,
    uri_decode: uri_decode,
    random_gen: random_gen,
    ranged_random_gen: ranged_random_gen,
    iterator: iterator,
    list: list,
    head: head,
    accumulate: accumulate,
    best: best,
    all: all,
    any: any,
    zip: zip,
    cart: cart,
    church: church,
    Y: Y,
    memorize: memorize,
    square: square,
    cube: cube,
    sum: sum,
    max: max,
    min: min,
    max_index: max_index,
    min_index: min_index
  };
}

//# sourceMappingURL=coffee_mate.map
